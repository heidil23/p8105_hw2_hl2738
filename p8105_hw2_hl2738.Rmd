---
title: "P8105 Homework 2"
author: Heidi Lumish
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(readxl)
library(dplyr)
```

## Problem 1

#### Set up the Mr. Trash Wheel data set

Here we will read in the Mr. Trash Wheel Excel sheet and clean the data.

```{r}
trash_wheel_df =
  read_excel(
    "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
    sheet = "Mr. Trash Wheel",
    range = "A2:N408") %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(sports_balls = as.integer(sports_balls))
```

#### Set up the precipitation data set

Next we will read in and clean the precipitation data for 2018 and 2019.
Then we will combine the 2018 and 2019 precpitation data sets into a new data frame.

```{r}
precipitation_2018 =
  read_excel(
    "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
    sheet = "2018 Precipitation",
    range = "A2:B14") %>% 
  janitor::clean_names() %>% 
  drop_na(total) %>%
  rename("2018" = total)

precipitation_2019 =
  read_excel(
    "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
    sheet = "2019 Precipitation",
    range = "A2:B14") %>% 
  janitor::clean_names() %>% 
  drop_na(total) %>%
  rename("2019" = total)

precipitation_df =
  left_join(precipitation_2018, precipitation_2019, by = "month") %>% 
  mutate(month = month.name[month])
```

#### Summarize the Mr. Trash Wheel data set

Mr. Trash Wheel is a "water-wheel vessel that removes trash from the Inner Harbor in Baltimore, Maryland." The Mr. Trash Wheel data set contains information on `r nrow(trash_wheel_df)` dumpsters, with litter collected between `r min(pull(trash_wheel_df, year))` and `r max(pull(trash_wheel_df, year))`. There was a total of `r sum(pull(trash_wheel_df, weight_tons))` tons of litter, with a volume of `r sum(pull(trash_wheel_df, volume_cubic_yards))` cubic yards, removed during this time. The type of litter collected included
`r format(sum(pull(trash_wheel_df, plastic_bottles)), scientific = FALSE)` plastic bottles,
`r format(sum(pull(trash_wheel_df, polystyrene)), scientific = FALSE)` foam containers,
`r sum(pull(trash_wheel_df, glass_bottles))` glass bottles,
`r format(sum(pull(trash_wheel_df, grocery_bags)), scientific = FALSE)` grocery bags,
`r format(sum(pull(trash_wheel_df, chip_bags)), scientific = FALSE)` chip bags, and
`r sum(pull(trash_wheel_df, sports_balls))` sports balls.
The median number of sports balls collected each year was
`r median(trash_wheel_df$sports_balls[trash_wheel_df$year == "2014"])` in 2014,
`r median(trash_wheel_df$sports_balls[trash_wheel_df$year == "2015"])` in 2015,
`r median(trash_wheel_df$sports_balls[trash_wheel_df$year == "2016"])` in 2016,
`r median(trash_wheel_df$sports_balls[trash_wheel_df$year == "2017"])` in 2017,
`r median(trash_wheel_df$sports_balls[trash_wheel_df$year == "2018"])` in 2018, and
`r median(trash_wheel_df$sports_balls[trash_wheel_df$year == "2019"])` in 2019.

#### Summarize the precipitation data set

The precipitation dataset summarizes the precipitation during `r nrow(precipitation_df)` months in 2018 and 2019. The total precipitation in between January and December 2018 was `r sum(pull(precipitation_df, "2018"))` inches. The median monthly precipitation was `r median(pull(precipitation_df, "2018"))` inches. The maximum monthly precipitation in 2018 was `r max(pull(precipitation_df, "2018"))` inches and occurred during the month of September. For 2019, precipitation data is available only between January and June. The total precipitation in 2019 was `r sum(pull(precipitation_df, "2019"), na.rm = TRUE)` inches. The median monthly precipitation was `r median(pull(precipitation_df, "2019"), na.rm = TRUE)` and the maximum monthly precipitation was `r max(pull(precipitation_df, "2019"), na.rm = TRUE)` inches and occurred in March.

## Problem 2

#### Import and clean the pols-month file

First, we will import and clean the data in pols-month.csv. Below is the code to convert the variable "mon" to separate "day," "month," and "year" variables. In addition, the code below creates a new variable "president" with levels "gop" and "dem," and then removes the prez_dem, prez_gop, and day variables.

```{r, message = FALSE}
pols_df = read_csv("./data/pols-month.csv") %>% 
  janitor::clean_names() %>% 
  separate(mon,
           c("year", "month", "day"),
           sep = "([-])",
           convert = TRUE) %>% 
  mutate(month = month.name[month]) %>% 
  mutate(president = ifelse(prez_dem == "1", "dem", "gop")) %>% 
  select(-prez_dem, -prez_gop, -day) %>% 
  relocate(year, month, president)
```

#### Import and clean the snp file

Next we will import and clean the data in the snp.csv file. 

```{r, message = FALSE}
snp_df = read_csv("./data/snp.csv") %>% 
  janitor::clean_names() %>%
  separate(date,
           c("month", "day", "year"),
           sep = "([/])",
           convert = TRUE) %>%
  mutate(month = month.name[month]) %>% 
  select(-day) %>%
  relocate(year, month)
```

#### Import and clean the unmployment file

Next we will import and clean the data in the unemployment file. 

```{r, message = FALSE}
unemployment_df = read_csv("./data/unemployment.csv") %>% 
  janitor::clean_names() %>% 
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "percent"
  )%>% 
  mutate(
    month =
           case_when(
             month == "jan" ~ "January",
             month == "feb" ~ "February",
             month == "mar" ~ "March",
             month == "apr" ~ "April",
             month == "may" ~ "May",
             month == "jun" ~ "June",
             month == "jul" ~ "July",
             month == "aug" ~ "August",
             month == "sep" ~ "September",
             month == "oct" ~ "October",
             month == "nov" ~ "November",
             month == "dec" ~ "December"))
```

#### Merge the three data sets: pols, snp, and unemployment

Finally, we will merge the three data sets together.

```{r}
five_thirty_eight_df =
  left_join(pols_df, snp_df, by = c("year", "month")) %>% 
              left_join(., unemployment_df, by = c("year", "month"))
```

